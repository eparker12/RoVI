if ("output_module4" %in% list.files()==FALSE) {
system("mkdir output_module4")
system("mkdir output_module4/RF_output_stats")
system("mkdir output_module4/RF_output_importance")
}
# load packages and functions
source("input/packages_and_functions.R")
source("input/RF_functions.R")
# load genus/rsv-level data - full and rarefied
load("phyloseq_files/ps7_genus.RData")
load("phyloseq_files/ps7_l_t_pr_d_dd_25k.RData")
load("phyloseq_files/ps8_genus.RData")
load("phyloseq_files/ps8_l_t_pr_d_dd_25k_rarefied.RData")
# select BS1, BS2, BS3, BS5 and MS1 samples within each phyloseq object
ps7_genus = subset_samples(ps7_genus, sample_type=="BS1" | sample_type=="BS2" | sample_type=="BS3" | sample_type=="BS5" | sample_type=="MS1") %>% prune_taxa(taxa_sums(.) > 0, .)
ps7 = subset_samples(ps7_l_t_pr_d_dd_25k, sample_type=="BS1" | sample_type=="BS2" | sample_type=="BS3" | sample_type=="BS5" | sample_type=="MS1") %>% prune_taxa(taxa_sums(.) > 0, .)
ps8_genus = subset_samples(ps8_genus, sample_type=="BS1" | sample_type=="BS2" | sample_type=="BS3" | sample_type=="BS5" | sample_type=="MS1") %>% prune_taxa(taxa_sums(.) > 0, .)
ps8 = subset_samples(ps8_l_t_pr_d_dd_25k_rarefied, sample_type=="BS1" | sample_type=="BS2" | sample_type=="BS3" | sample_type=="BS5" | sample_type=="MS1") %>% prune_taxa(taxa_sums(.) > 0, .)
#all(sample_names(ps7_genus)==sample_names(ps8_genus))
# amend taxa names to be consistent across ps7 and ps8 levels
taxa_names(ps7_genus) = data.frame(as(tax_table(ps7_genus), "matrix"))$Genus
taxa_names(ps7) = data.frame(as(tax_table(ps7), "matrix"))$tax_id
taxa_names(ps8_genus) = data.frame(as(tax_table(ps8_genus), "matrix"))$Genus
taxa_names(ps8) = data.frame(as(tax_table(ps8), "matrix"))$tax_id
# transform to relative abundances
rps7_genus = transform_sample_counts(ps7_genus, function(x) {x/sum(x)})
rps7 = transform_sample_counts(ps7, function(x) {x/sum(x)})
rps8_genus = transform_sample_counts(ps8_genus, function(x) {x/sum(x)})
rps8 = transform_sample_counts(ps8, function(x) {x/sum(x)})
set.seed(23456)
rps = rps8_genus
ps = ps7_genus
input_m = data.frame(sample_data(rps))
country_list = c("India", "India (exposed)", "India (unexposed)", "Malawi", "UK")
outcome = "BB2_IgA"
level = "genus"
run_rf_full
run_rf_full=T
if (run_rf_full) { collate_rf_IgA("crossval_collated_genus_IgA.csv") }
subset_list = c("BS1", "BS2", "BS3", "BS5", "MS1")
if (run_rf_full) { collate_rf_IgA("crossval_collated_genus_IgA.csv") }
# load RoVI packages and functions
source("input/packages_and_functions.R")
# import metadata, and create India-specific subset for analyses of study arm
s = read.csv("input/RoVI_metadata_by_family_03112020.csv", header=TRUE, stringsAsFactors=FALSE)
# updated coding for country
s$country_full = s$country
s$country[s$country=="India"] = "IND"
s$country[s$country=="Malawi"] = "MLW"
s$country[s$country=="UK"] = "UK"
# updated coding for country/arm
s$country_arm_full = s$country_arm
s$country_arm[s$country_arm=="India (OPV)"] = "IND (OPV)"
s$country_arm[s$country_arm=="India (IPV)"] = "IND (IPV)"
s$country_arm[s$country_arm=="Malawi"] = "MLW"
s$country_arm[s$country_arm=="UK"] = "UK"
# updated coding for country/neo+
s$country_exposure_full = s$country_exposure
s$country_exposure[s$country_exposure=="India (exposed)"] = "IND (neo+)"
s$country_exposure[s$country_exposure=="India (unexposed)"] = "IND (neo-)"
s$country_exposure[s$country_exposure=="Malawi"] = "MLW"
s$country_exposure[s$country_exposure=="UK"] = "UK"
sI = subset(s, country=="IND")
# load RoVI packages and functions
source("input/packages_and_functions.R")
# import metadata, and create India-specific subset for analyses of study arm
s = read.csv("input/RoVI_metadata_by_family_03112020.csv", header=TRUE, stringsAsFactors=FALSE)
# updated coding for country
s$country_full = s$country
s$country[s$country=="India"] = "IND"
s$country[s$country=="Malawi"] = "MLW"
s$country[s$country=="UK"] = "UK"
# updated coding for country/arm
s$country_arm_full = s$country_arm
s$country_arm[s$country_arm=="India (OPV)"] = "IND (OPV)"
s$country_arm[s$country_arm=="India (IPV)"] = "IND (IPV)"
s$country_arm[s$country_arm=="Malawi"] = "MLW"
s$country_arm[s$country_arm=="UK"] = "UK"
# updated coding for country/neo+
s$country_exposure_full = s$country_exposure
s$country_exposure[s$country_exposure=="India (exposed)"] = "IND (neo+)"
s$country_exposure[s$country_exposure=="India (unexposed)"] = "IND (neo-)"
s$country_exposure[s$country_exposure=="Malawi"] = "MLW"
s$country_exposure[s$country_exposure=="UK"] = "UK"
sI = subset(s, country=="IND")
s$n = 1
t = data.frame(
n = table(!is.na(s$n), s$country)[1,],
neonatal_shedding = table(!is.na(s$BS1_VP6_ct), s$country)[2,],
dose1_shedding = table(!is.na(s$dose1_shedding), s$country)[2,],
dose2_shedding = table(!is.na(s$dose2_shedding), s$country)[2,],
either_shedding = table(!is.na(s$either_shedding), s$country)[2,],
seroconv = table(!is.na(s$seroconv), s$country)[2,],
any_response = table(!is.na(s$any_response), s$country)[2,])
t
rm(t)
p1 = fig_cat(s, "BS1_VP6_cat", title="neonatal RV shedding,\nweek of life 1") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 1.0625, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=India_col)
p2 = fig_cat(s, "dose1_shedding", title="ORV shedding after dose 1,\nweek of life 7")  + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
p3 = fig_cat(s, "either_shedding", title="ORV shedding after either dose,\nweek of life 7/11")  + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="**", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
grid.arrange(p1,p2,p3, ncol=4)
rm(p1,p2,p3)
outcome_summary(s, "BS1_VP6_cat")
p_summary(s, "BS1_VP6_cat")
outcome_summary(s, "dose1_shedding")
p_summary(s, "dose1_shedding")
outcome_summary(s, "dose2_shedding")
p_summary(s, "dose2_shedding")
outcome_summary(s, "either_shedding")
p_summary(s, "either_shedding")
outcome_summary(s, "both_shedding")
p_summary(s, "both_shedding")
p1 = fig_cat(s, "MS1_VP6_cat", title="mother") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="ns", y_position = 1.125, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 1.0625, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="ns", y_position = 1, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey")
p2 = fig_cat(s, "BS1_VP6_cat", title="week of life 1") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 1.0625, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=India_col)
p3 = fig_cat(s, "BS2_VP6_cat", title="week of life 4") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="**", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 1.0625, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="*", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
p4 = fig_cat(s, "BS3_VP6_cat", title="week of life 6") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="*", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="*", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
p5 = fig_cat(s, "BS4_VP6_cat", title="week of life 7") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
p6 = fig_cat(s, "BS5_VP6_cat", title="week of life 10") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="**", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
p7 = fig_cat(s, "BS6_VP6_cat", title="week of life 11") + ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="*", y_position = 1, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col)
grid.arrange(p1,p2,p3,p4,p5,p6,p7, ncol=7)
rm(p1,p2,p3,p4,p5,p6,p7)
outcome_summary(s, "MS1_VP6_cat")
p_summary(s, "MS1_VP6_cat")
outcome_summary(s, "BS1_VP6_cat")
p_summary(s, "BS1_VP6_cat")
outcome_summary(s, "BS2_VP6_cat")
p_summary(s, "BS2_VP6_cat")
outcome_summary(s, "BS3_VP6_cat")
p_summary(s, "BS3_VP6_cat")
outcome_summary(s, "BS4_VP6_cat")
p_summary(s, "BS4_VP6_cat")
outcome_summary(s, "BS5_VP6_cat")
p_summary(s, "BS5_VP6_cat")
outcome_summary(s, "BS6_VP6_cat")
p_summary(s, "BS6_VP6_cat")
s1 = subset(s, !is.na(BS1_VP6_cat) & !is.na(dose1_shedding) & !is.na(dose2_shedding) & !is.na(BB2_IgA))
table(s1$country)
s2 = subset(s1, either_shedding==1)
ggplot(s2, aes(factor(country), y=min_RV1_Ct, colour=factor(country))) + geom_jitter(size = 1.5, alpha = 0.3, width=0.3) +
geom_boxplot(alpha = 0.5) + ylab("minimum Ct") + xlab("") + theme(legend.position = "none", strip.background = element_blank()) +
scale_colour_manual(values = c("IND" = India_col, "MLW" = Malawi_col, "UK" = UK_col)) +
scale_y_continuous(limits=c(15,42.5), breaks=c(20,25,30,35,40)) + scale_y_reverse() +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = -10, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = -12.5, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="*", y_position = -15, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=Malawi_col) +
theme(text = element_text(size=18), axis.text = element_text(size=18), axis.title = element_text(size=20))
t = data.frame(comp = c("IND-MLW", "UK-MLW", "IND-UK"),
p = c(wilcox.test(s2$min_RV1_Ct[s2$country!="UK"] ~ s2$country[s2$country!="UK"])$p.value,
wilcox.test(s2$min_RV1_Ct[s2$country!="IND"] ~ s2$country[s2$country!="IND"])$p.value,
wilcox.test(s2$min_RV1_Ct[s2$country!="MLW"] ~ s2$country[s2$country!="MLW"])$p.value))
t$fdr = p.adjust(t$p, method="fdr")
t
rm(t)
sI$n = 1
t = data.frame(
n = table(!is.na(sI$n), sI$country_arm)[1,],
neonatal_shedding = table(!is.na(sI$BS1_VP6_ct), sI$country_arm)[2,],
dose1_shedding = table(!is.na(sI$dose1_shedding), sI$country_arm)[2,],
dose2_shedding = table(!is.na(sI$dose2_shedding), sI$country_arm)[2,],
either_shedding = table(!is.na(sI$either_shedding), sI$country_arm)[2,],
seroconv = table(!is.na(sI$seroconv), sI$country_arm)[2,],
any_response = table(!is.na(sI$any_response), sI$country_arm)[2,])
t
rm(t)
p1 = fig_cat(sI, "BS1_VP6_cat", title="neonatal RV shedding,\nweek of life 1") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.75, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey")
p2 = fig_cat(sI, "dose1_shedding", title="ORV shedding after dose 1,\nweek of life 7") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="***", y_position = 0.75, tip_length=0, vjust=0.5, size = 0.5, textsize=8, color=India_IPV_col)
p3 = fig_cat(sI, "either_shedding", title="ORV shedding after either dose,\nweek of life 7/11") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.75, tip_length=0, vjust=0, size = 0.5, textsize=5, color="grey")
grid.arrange(p1,p2,p3, ncol=4)
rm(p1,p2,p3)
outcome_summary(sI, "BS1_VP6_cat")
p_summary(sI, "BS1_VP6_cat")
outcome_summary(sI, "dose1_shedding")
p_summary(sI, "dose1_shedding")
outcome_summary(sI, "dose2_shedding")
p_summary(sI, "dose2_shedding")
outcome_summary(sI, "either_shedding")
p_summary(sI, "either_shedding")
outcome_summary(sI, "both_shedding")
p_summary(sI, "both_shedding")
p1 = fig_cat(sI, "MS1_VP6_cat", title="maternal") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p2 = fig_cat(sI, "BS1_VP6_cat", title="week of life 1") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.625, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p3 = fig_cat(sI, "BS2_VP6_cat", title="week of life 4") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p4 = fig_cat(sI, "BS3_VP6_cat", title="week of life 6") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p5 = fig_cat(sI, "BS4_VP6_cat", title="week of life 7") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="**", y_position = 0.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_IPV_col)
p6 = fig_cat(sI, "BS5_VP6_cat", title="week of life 10") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="*", y_position = 0.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_IPV_col)
p7 = fig_cat(sI, "BS6_VP6_cat", title="week of life 11") + ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="*", y_position = 0.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_OPV_col)
grid.arrange(p1,p2,p3,p4,p5,p6,p7, ncol=7)
rm(p1,p2,p3,p4,p5,p6,p7)
outcome_summary(sI, "MS1_VP6_cat")
p_summary(sI, "MS1_VP6_cat")
outcome_summary(sI, "BS1_VP6_cat")
p_summary(sI, "BS1_VP6_cat")
outcome_summary(sI, "BS3_VP6_cat")
p_summary(sI, "BS3_VP6_cat")
outcome_summary(sI, "BS4_VP6_cat")
p_summary(sI, "BS4_VP6_cat")
outcome_summary(sI, "BS5_VP6_cat")
p_summary(sI, "BS5_VP6_cat")
outcome_summary(sI, "BS6_VP6_cat")
p_summary(sI, "BS6_VP6_cat")
s1I = subset(sI, !is.na(BS1_VP6_cat) & !is.na(dose1_shedding) & !is.na(dose2_shedding) & !is.na(BB2_IgA))
table(s1I$country_arm)
s2I = subset(s1I, either_shedding==1)
ggplot(s2I, aes(factor(country_arm), y=min_RV1_Ct, colour=factor(country_arm))) + geom_jitter(size = 1.5, alpha = 0.3, width=0.3) +
geom_boxplot(alpha = 0.5) + ylab("minimum Ct") + xlab("") + theme(legend.position = "none", strip.background = element_blank()) +
scale_colour_manual(values = c("IND (OPV)" = India_col, "IND (IPV)" = India_IPV_col)) +
scale_y_continuous(limits=c(15,42.5), breaks=c(20,25,30,35,40)) + scale_y_reverse() +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = -20, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
theme(text = element_text(size=18), axis.text = element_text(size=18), axis.title = element_text(size=20))
data.frame(comp = "OPV-IPV",
p = wilcox.test(s2I$min_RV1_Ct ~ s2I$country_arm)$p.value)
p1 = fig_cat(s, "seroconv", title="\nseroconversion") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="**", y_position = 1.125, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="**", y_position = 1.0625, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="ns", y_position = 1, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p2 = fig_cont_log10(subset(s, !is.na(BB1_IgA)), "BB1_IgA", "RV-IgA (IU/ml)") + geom_hline(yintercept = 20, linetype="dotted") + ggtitle("infant RV-IgA pre-ORV,\nweek of life 6") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 4, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 3.75, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "IND")), annotations="***", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col)
p3 = fig_cont_log10(subset(s, !is.na(BB2_IgA)), "BB2_IgA", "RV-IgA (IU/ml)") + geom_hline(yintercept = 20, linetype="dotted") + ggtitle("infant RV-IgA post-ORV,\nweek of life 14") +
ylab(" ") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="ns", y_position = 4, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="**", y_position = 3.75, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "IND")), annotations="***", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col)
grid.arrange(p1,p2,p3,ncol=4)
rm(p1,p2,p3)
p4 = fig_cat(s, "BB1_IgA_cat", title="seropositive pre-ORV,\nweek of life 6") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 1.125, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 1.0625, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col)
p5 = fig_cat(s, "BB2_IgA_cat", title="seropositive post-ORV,\nweek of life 14") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="ns", y_position = 1.125, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="***", y_position = 1.0625, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("IND", "MLW")), annotations="***", y_position = 1, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col)
grid.arrange(p4,p5,ncol=2)
rm(p4,p5)
outcome_summary(s, "seroconv")
p_summary(s, "seroconv")
outcome_summary(s, "BB1_IgA_cat")
p_summary(s, "BB1_IgA_cat")
outcome_summary(s, "BB2_IgA_cat")
p_summary(s, "BB2_IgA_cat")
gmt_summary(s, "BB1_IgA")
p_summary_gmt(s, "BB1_IgA")
gmt_summary(s, "BB2_IgA")
p_summary_gmt(s, "BB2_IgA")
table(sI$BS1_VP6_cat, sI$BB1_IgA_cat)
table(s$pre_exposed, s$country)
p1 = fig_cat(sI, "seroconv", title="\nseroconversion") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p2 = fig_cont_log10(subset(sI, !is.na(BB1_IgA)), "BB1_IgA", "RV-IgA (IU/ml)") + geom_hline(yintercept = 20, linetype="dotted") + ggtitle("infant RV-IgA pre-ORV,\nweek of life 6") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 3.25, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p3 = fig_cont_log10(subset(sI, !is.na(BB2_IgA)), "BB2_IgA", "RV-IgA (IU/ml)") + geom_hline(yintercept = 20, linetype="dotted") + ggtitle("infant RV-IgA post-ORV,\nweek of life 14") +
ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 3.25, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
grid.arrange(p1,p2,p3,ncol=3)
rm(p1,p2,p3)
p4 = fig_cat(sI, "BB1_IgA_cat", title="seropositive pre-ORV,\nweek of life 6") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p5 = fig_cat(sI, "BB2_IgA_cat", title="seropositive post-ORV,\nweek of life 14") +
ylab(" ") +
geom_signif(comparisons = list(c("IND (OPV)", "IND (IPV)")), annotations="ns", y_position = 0.75, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
grid.arrange(p4,p5,ncol=2)
rm(p4,p5)
outcome_summary(sI, "seroconv")
p_summary(sI, "seroconv")
outcome_summary(sI, "BB1_IgA_cat")
p_summary(sI, "BB1_IgA_cat")
outcome_summary(sI, "BB2_IgA_cat")
p_summary(sI, "BB2_IgA_cat")
gmt_summary(sI, "BB1_IgA")
p_summary_gmt(sI, "BB1_IgA")
gmt_summary(sI, "BB2_IgA")
p_summary_gmt(sI, "BB2_IgA")
s1 = subset(s, !is.na(BS1_VP6_cat) & !is.na(dose1_shedding) & !is.na(dose2_shedding) & !is.na(BB1_IgA) & !is.na(BB2_IgA))
table(s1$country)
# create new variable for birth/vaccine shedding group
s1$shedding_group = NA
s1$shedding_group[(s1$BS1_VP6_cat==0 & s1$BB1_IgA_cat==0) & s1$either_shedding==0] = "--"
s1$shedding_group[(s1$BS1_VP6_cat==0 & s1$BB1_IgA_cat==0) & s1$either_shedding==1] = "-+"
s1$shedding_group[(s1$BS1_VP6_cat==1 | s1$BB1_IgA_cat==1)  & s1$either_shedding==0] = "+-"
s1$shedding_group[(s1$BS1_VP6_cat==1 | s1$BB1_IgA_cat==1)  & s1$either_shedding==1] = "++"
table(s1$country, s1$shedding_group)
# create plot for India, including all shedding subgroups with ≥5 infants
s1I = subset(s1, country=="IND" & !is.na(shedding_group) & !is.na(BB2_IgA))
p1 = ggplot(s1I, aes(factor(shedding_group), y=BB2_IgA, colour=factor(shedding_group))) + geom_jitter(size = 1.5, alpha = 0.3, width=0.3, colour=India_col) +
geom_boxplot(alpha = 0.5, colour=India_col) + ylab("RV-IgA (IU/ml)") + xlab("") +
theme(legend.position = "none", strip.background = element_blank()) + geom_hline(yintercept = 20, linetype="dotted") +
# scale_colour_manual(values = c("#d4b9da","#df65b0", "#ce1256", "#91003f")) +
scale_y_continuous(trans="log10", breaks = c(1,10,100,1000), limits = c(1,35000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("++", "--")), annotations="***", y_position = 4.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("++", "-+")), annotations="***", y_position = 4.25, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("++", "+-")), annotations="**", y_position = 4, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("+-", "--")), annotations="***", y_position = 3.75, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("+-", "-+")), annotations="***", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=India_col) +
geom_signif(comparisons = list(c("-+", "--")), annotations="ns", y_position = 3.25, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
ggtitle("IND") + theme(plot.title = element_text(size=18, hjust = 0.5)) +
theme(text = element_text(size=18), axis.text = element_text(size=18), axis.title = element_text(size=20))
# create plot for Malawi, including all shedding subgroups with ≥5 infants
s1M = subset(s1, country=="MLW" & (shedding_group=="--" | shedding_group=="-+") & !is.na(BB2_IgA))
p2 = ggplot(s1M, aes(factor(shedding_group), y=BB2_IgA, colour=factor(shedding_group))) + geom_jitter(size = 1.5, alpha = 0.3, width=0.3, colour = Malawi_col) +
geom_boxplot(alpha = 0.5, colour = Malawi_col) + ylab("") + xlab("") + theme(legend.position = "none", strip.background = element_blank()) + geom_hline(yintercept = 20, linetype="dotted") +
scale_y_continuous(trans="log10", breaks = c(1,10,100,1000), limits = c(1,35000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("-+", "--")), annotations="*", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=Malawi_col) +
ggtitle("MLW")+ theme(plot.title = element_text(size=18, hjust = 0.5)) +
theme(text = element_text(size=18), axis.text = element_text(size=18), axis.title = element_text(size=20))
# create plot for UK, including all shedding subgroups with ≥5 infants
s1U = subset(s1, country=="UK" & shedding_group=="-+" & !is.na(BB2_IgA))
p3 = ggplot(s1U, aes(factor(shedding_group), y=BB2_IgA, colour=factor(shedding_group))) + geom_jitter(size = 1.5, alpha = 0.3, width=0.3) +
geom_boxplot(alpha = 0.5) + ylab("") + xlab("") + theme(legend.position = "none", strip.background = element_blank()) + geom_hline(yintercept = 20, linetype="dotted") +
scale_colour_manual(values = c(UK_col)) +
scale_y_continuous(trans="log10", breaks = c(1,10,100,1000), limits = c(1,35000), labels = trans_format("log10", math_format(10^.x))) +
ggtitle("UK") +theme(plot.title = element_text(size=18, hjust = 0.5)) +
theme(text = element_text(size=18), axis.text = element_text(size=18), axis.title = element_text(size=20))
grid.arrange(p1,p2,p3, widths=c(4,2.5,1.5), ncol=3)
rm(p1,p2,p3)
TukeyHSD(x=aov(log10(s1I$BB2_IgA) ~ s1I$shedding_group), "s1I$shedding_group", conf.level=0.95)[1]
TukeyHSD(x=aov(log10(s1M$BB2_IgA) ~ s1M$shedding_group), "s1M$shedding_group", conf.level=0.95)[1]
rm(s1I, s1M, s1U)
t = subset(s, country=="IND" & !is.na(MB1_IgA) & !is.na(MB1_IgG) & !is.na(CB1_IgG) & !is.na(BB1_IgG) & pre_exposed==0)
nrow(t)
cor.test(log(t$MB1_IgA), log(t$MB1_IgG), method="pearson")
p1 = fig_cont_log10(subset(s, !is.na(MB1_IgA)), "MB1_IgA", "IU/ml") + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("maternal RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="ns", y_position = 4, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="*", y_position = 3.75, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=Malawi_col) +
geom_signif(comparisons = list(c("MLW", "IND")), annotations="***", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=Malawi_col)
p2 = fig_cont_log10(subset(s, !is.na(BM1_IgA)), "BM1_IgA", " ") + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("breastmilk RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND", "UK")), annotations="***", y_position = 4, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=UK_col) +
geom_signif(comparisons = list(c("MLW", "UK")), annotations="ns", y_position = 3.75, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey") +
geom_signif(comparisons = list(c("MLW", "IND")), annotations="***", y_position = 3.5, tip_length=0, vjust=0.5,  size = 0.5, textsize=8, color=Malawi_col)
grid.arrange(p1,p2,ncol=3)
rm(p1,p2)
gmt_summary(s, "MB1_IgA")
p_summary_gmt(s, "MB1_IgA")
gmt_summary(s, "BM1_IgA")
p_summary_gmt(s, "BM1_IgA")
p1 = fig_cont_log10(subset(sI, !is.na(MB1_IgA)), "MB1_IgA", "IU/ml") + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("maternal RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND (IPV)", "IND (OPV)")), annotations="ns", y_position = 4, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p2 = fig_cont_log10(subset(sI, !is.na(BM1_IgA)), "BM1_IgA", " ") + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("breastmilk RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND (IPV)", "IND (OPV)")), annotations="ns", y_position = 4, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p3 = fig_cont_log10(subset(sI, !is.na(MB1_IgG)), "MB1_IgG", " ") +
ggtitle("maternal RV-IgG,\ninfant week of life 1") +
scale_y_continuous(trans="log10", breaks = c(0,1,10,100,1000,10000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("IND (IPV)", "IND (OPV)")), annotations="ns", y_position = 5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
p4 = fig_cont_log10(subset(sI, !is.na(CB1_IgG)), "CB1_IgG", " ") +
ggtitle("\ncord blood RV-IgG,\ninfant week of life 0") +
scale_y_continuous(trans="log10", breaks = c(0,1,10,100,1000,10000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("IND (IPV)", "IND (OPV)")), annotations="ns", y_position = 5, tip_length=0, vjust=0,  size = 0.5, textsize=5, color="grey")
grid.arrange(p1,p2,p3,p4,ncol=4)
rm(p1,p2,p3,p4)
gmt_summary(sI, "MB1_IgA")
p_summary_gmt(sI, "MB1_IgA")
gmt_summary(sI, "BM1_IgA")
p_summary_gmt(sI, "BM1_IgA")
gmt_summary(sI, "MB1_IgG")
p_summary_gmt(sI, "MB1_IgG")
gmt_summary(sI, "CB1_IgG")
p_summary_gmt(sI, "CB1_IgG")
sI = subset(sI, pre_exposed==1 | pre_exposed==0)
p1 = fig_cont_log10(subset(sI, !is.na(MB1_IgA)), "MB1_IgA", "IU/ml", exposure=TRUE) + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("maternal RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND (neo+)", "IND (neo-)")), annotations="ns", y_position = 4, tip_length=0, vjust=0, size = 0.3, textsize=5, color="grey")
p2 = fig_cont_log10(subset(sI, !is.na(BM1_IgA)), "BM1_IgA", " ", exposure=TRUE) + geom_hline(yintercept = 20, linetype="dotted") +
ggtitle("breastmilk RV-IgA,\ninfant week of life 1") +
geom_signif(comparisons = list(c("IND (neo+)", "IND (neo-)")), annotations="ns", y_position = 4, tip_length=0, vjust=0, size = 0.3, textsize=5, color="grey")
p3 = fig_cont_log10(subset(sI, !is.na(MB1_IgG)), "MB1_IgG", " ", exposure=TRUE) +
ggtitle("maternal RV-IgG,\ninfant week of life 1") +
scale_y_continuous(trans="log10", breaks = c(0,1,10,100,1000,10000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("IND (neo+)", "IND (neo-)")), annotations="ns", y_position = 5, tip_length=0, vjust=0, size = 0.3, textsize=5, color="grey")
p4 = fig_cont_log10(subset(sI, !is.na(CB1_IgG)), "CB1_IgG", " ", exposure=TRUE) +
ggtitle("cord blood RV-IgG,\ninfant week of life 0") +
scale_y_continuous(trans="log10", breaks = c(0,1,10,100,1000,10000), labels = trans_format("log10", math_format(10^.x))) +
geom_signif(comparisons = list(c("IND (neo+)", "IND (neo-)")), annotations="ns", y_position = 5, tip_length=0, vjust=0, size = 0.3, textsize=5, color="grey")
grid.arrange(p1,p2,p3,p4,ncol=4)
rm(p1,p2,p3,p4)
gmt_summary(sI, "MB1_IgA", exposure=TRUE)
p_summary_gmt(sI, "MB1_IgA", exposure=TRUE)
gmt_summary(sI, "BM1_IgA", exposure=TRUE)
p_summary_gmt(sI, "BM1_IgA", exposure=TRUE)
gmt_summary(sI, "MB1_IgG", exposure=TRUE)
p_summary_gmt(sI, "MB1_IgG", exposure=TRUE)
gmt_summary(sI, "CB1_IgG", exposure=TRUE)
p_summary_gmt(sI, "CB1_IgG", exposure=TRUE)
s_sub = subset(s, country=="IND")
cor.test(log(s_sub$MB1_IgA), log(s_sub$CB1_IgG), method="pearson")
s_Ig = s_sub[,c("MB1_IgG", "CB1_IgG", "MB1_IgA", "BM1_IgA", "BB1_IgA", "BB2_IgA",  "BS1_VP6_quant", "BS4_nsp2_quant")]
s_Ig = s_Ig[complete.cases(s_Ig),]
col = colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
p.mat = cor.mtest(s_Ig, method="spearman")
m = cor(s_Ig, method="spearman")
colnames(m) = rownames(m) = c("maternal RV-IgG","cord blood RV-IgG","maternal RV-IgA","breastmilk RV-IgA","infant RV-IgA, pre-ORV", "infant RV-IgA, post-ORV","RV shedding, week of life 1","post-ORV shedding, dose 1")
col2 <- colorRampPalette(c("#67001F", "#B2182B", "#D6604D", "#F4A582", "#FDDBC7", "#FFFFFF", "#D1E5F0", "#92C5DE", "#4393C3", "#2166AC", "#053061"))
corrplot(m, method="color", type = "upper", order = "original", tl.col="black", col=col2(200),
p.mat = p.mat[[1]], insig = "label_sig", tl.cex = 1.2, cl.cex = 1.1, pch.cex = 1.5, diag = FALSE,
cl.length = 5, addgrid.col = "white",
sig.level = c(.0005, .005, .05),  pch.col = "black")
#rm(s_sub, p.mat, m)
s_sub = subset(s, country=="IND" & pre_exposed==1)
s_Ig = s_sub[,c("MB1_IgG", "CB1_IgG", "MB1_IgA", "BM1_IgA", "BB1_IgA", "BB2_IgA",  "BS1_VP6_quant", "BS4_nsp2_quant")]
s_Ig = s_Ig[complete.cases(s_Ig),]
p.mat = cor.mtest(s_Ig, method="spearman")
m = cor(s_Ig, method="spearman")
colnames(m) = rownames(m) = c("maternal RV-IgG","cord blood RV-IgG","maternal RV-IgA","breastmilk RV-IgA","infant RV-IgA, pre-ORV", "infant RV-IgA, post-ORV","RV shedding, week of life 1","post-ORV shedding, dose 1")
corrplot(m, method="color", type = "upper", order = "original", tl.col="black", col=col2(200),
p.mat = p.mat[[1]], insig = "label_sig", tl.cex = 1.2, cl.cex = 1.1, pch.cex = 1.5, diag = FALSE,
cl.length = 5, addgrid.col = "white",
sig.level = c(.0005, .005, .05), pch.col = "black")
rm(s_sub, p.mat, m)
data.frame(results)
results = data.frame(India_exposed = corr_by_country("BB1_IgA", "IND (neo+)", "corr"))
results = mutate_all(results, function(x) as.numeric(as.character(x)))
pvals = data.frame(India_exposed = corr_by_country("BB1_IgA", "IND (neo+)", "p"))
pvals = mutate_all(pvals, function(x) as.numeric(as.character(x)))
rownames(results) = rownames(pvals) = c("MB1 RV-IgA", "BM1 RV-IgA", "MB1 RV-IgG", "CB1 RV-IgG", "BB1 RV-IgG")
pheatmap(results, cluster_rows = F, cluster_cols = F,  color = col2(200), breaks = seq(-1, 1, by = 0.01))
corr_by_country = function(outcome_measure, country_exposure_subset, return_val, antibody=TRUE) {
if (antibody==TRUE) {
res = c(corr_function(s, outcome_measure, "MB1_IgA", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "BM1_IgA", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "BB1_IgA", country_exposure_subset, return_option=return_val))
if (country_exposure_subset != "UK" & country_exposure_subset != "MLW") {
res = c(res,
corr_function(s, outcome_measure, "MB1_IgG", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "CB1_IgG", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "BB1_IgG", country_exposure_subset, return_option=return_val))
} else { (res = c(res, NA, NA, NA)) }
} else {
res = c(corr_function(s, outcome_measure, "A1AT_BS3_Concugml", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "A1AT_BS5_Concugml", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "MPO_BS3_Concngml", country_exposure_subset, return_option=return_val),
corr_function(s, outcome_measure, "MPO_BS5_Concngml", country_exposure_subset, return_option=return_val))
if (country_exposure_subset == "UK") { res= c(res,NA) } else { res = c(res,corr_function(s, outcome_measure, "AG_Concugml", country_exposure_subset, return_option=return_val)) }
}
}
results = data.frame(India_exposed = corr_by_country("BB1_IgA", "IND (neo+)", "corr"))
results = mutate_all(results, function(x) as.numeric(as.character(x)))
pvals = data.frame(India_exposed = corr_by_country("BB1_IgA", "IND (neo+)", "p"))
pvals = mutate_all(pvals, function(x) as.numeric(as.character(x)))
rownames(results) = rownames(pvals) = c("MB1 RV-IgA", "BM1 RV-IgA", "MB1 RV-IgG", "CB1 RV-IgG", "BB1 RV-IgG")
rownames(results) = rownames(pvals) = c("MB1 RV-IgA", "BM1 RV-IgA", "BB1 RV-IgA", "MB1 RV-IgG", "CB1 RV-IgG", "BB1 RV-IgG")
pheatmap(results, cluster_rows = F, cluster_cols = F,  color = col2(200), breaks = seq(-1, 1, by = 0.01))
data.frame(results)
data.frame(pvals)
results = data.frame(India = corr_by_country("BB2_IgA", "IND", "corr"),
India_neo_pos = corr_by_country("BB2_IgA", "IND (neo+)", "corr"),
India_neo_neg = corr_by_country("BB2_IgA", "IND (neo-)", "corr"),
Malawi = corr_by_country("BB2_IgA", "MLW", "corr"),
UK = corr_by_country("BB2_IgA", "UK", "corr"))
results = mutate_all(results, function(x) as.numeric(as.character(x)))
pvals = data.frame(India = corr_by_country("BB2_IgA", "IND", "p"),
India_neo_pos = corr_by_country("BB2_IgA", "IND (neo+)", "p"),
India_neo_neg = corr_by_country("BB2_IgA", "IND (neo-)", "p"),
Malawi = corr_by_country("BB2_IgA", "MLW", "p"),
UK = corr_by_country("BB2_IgA", "UK", "p"))
pvals = mutate_all(pvals, function(x) as.numeric(as.character(x)))
cor_n = data.frame(India = corr_by_country("BB2_IgA", "IND", "n"),
India_neo_pos = corr_by_country("BB2_IgA", "IND (neo+)", "n"),
India_neo_neg = corr_by_country("BB2_IgA", "IND (neo-)", "n"),
Malawi = corr_by_country("BB2_IgA", "MLW", "n"),
UK = corr_by_country("BB2_IgA", "UK", "n"))
cor_n = mutate_all(cor_n, function(x) as.numeric(as.character(x)))
rownames(results) = rownames(pvals) = c("MB1 RV-IgA", "BM1 RV-IgA", "MB1 RV-IgG", "CB1 RV-IgG", "BB1 RV-IgG")
rownames(results) = rownames(pvals) = c("MB1 RV-IgA", "BM1 RV-IgA",  "BB1 RV-IgA", "MB1 RV-IgG", "CB1 RV-IgG", "BB1 RV-IgG")
pheatmap(results, cluster_rows = F, cluster_cols = F,  color = col2(200), breaks = seq(-1, 1, by = 0.01))
data.frame(results)
data.frame(pvals)
data.frame(cor_n)
m1 = lm(log(BB2_IgA) ~ log(MB1_IgA) + country, data=s)
summary(m1)
